<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suporte - Sercon</title>
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    
    <!-- Noto Emoji Animation - Emojis Animados do Google -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&display=swap" rel="stylesheet">
    
    <!-- Lottie para anima√ß√µes de emoji -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
    
    <link rel="stylesheet" href="Suporte-style.css">
    <script src="../shared/config.js"></script>
    <script src="../shared/constants.js"></script>
    <script src="../shared/utils.js"></script>
    <script src="../shared/supabase-sync.js"></script>
</head>
<body>
    <!-- Dominium Login -->
    <section id="dominium-login">
        <div class="login">
            <form id="dominiumLoginForm" action="#" class="login__form">
                <h1 class="login__title">Login</h1>

                <div class="login__content">
                    <div class="login__box">
                        <i class='bx bxs-building-house login__icon'></i>
                        
                        <div class="login__box-input">
                            <input type="text" id="dominiumLoginRazaoSocial" required class="login__input" placeholder="">
                            <label for="dominiumLoginRazaoSocial" class="login__label">Raz√£o Social</label>
                        </div>
                    </div>

                    <div class="login__box">
                        <i class='bx bxs-user login__icon'></i>
                        
                        <div class="login__box-input">
                            <input type="text" id="dominiumLoginUsername" required class="login__input" placeholder="">
                            <label for="dominiumLoginUsername" class="login__label">Username</label>
                        </div>
                    </div>

                    <div class="login__box">
                        <i class='bx bxs-lock-alt login__icon'></i>

                        <div class="login__box-input">
                            <input type="password" id="dominiumLoginPassword" required class="login__input" placeholder="">
                            <label for="dominiumLoginPassword" class="login__label">Password</label>
                        </div>
                    </div>
                </div>

                <div class="login__check">
                    <div class="login__check-group">
                        <input type="checkbox" id="rememberMe" class="login__check-input">
                        <label for="rememberMe" class="login__check-label">Lembrar de mim</label>
                    </div>
                </div>

                <button type="submit" class="login__button" id="dominiumLoginButton">Login</button>
            </form>
        </div>
    </section>

    <!-- Modal de Cadastro de Funcion√°rio - DEVE ESTAR FORA DO supportApp -->
    <div class="modal" id="supportAddEmployeeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Novo Funcion√°rio</h2>
                <button type="button" class="close-modal-btn" id="supportAddEmployeeClose">
                    <i class='bx bx-x'></i>
                </button>
            </div>
            <form id="supportAddEmployeeForm" class="form-onboarding">
                <div class="form-field">
                    <label for="supportEmployeeFullName">Nome Completo <span class="required">*</span></label>
                    <input type="text" id="supportEmployeeFullName" placeholder="Ex: Maria dos Santos" required>
                </div>
                <div class="form-field">
                    <label for="supportEmployeeUsername">Username (Login) <span class="required">*</span></label>
                    <input type="text" id="supportEmployeeUsername" placeholder="Ex: maria.santos" required>
                </div>
                <div class="form-field">
                    <label for="supportEmployeePassword">Senha <span class="required">*</span></label>
                    <input type="password" id="supportEmployeePassword" placeholder="Defina a senha" required>
                </div>
                <div class="form-field">
                    <label for="supportEmployeeConfirmPassword">Confirmar Senha <span class="required">*</span></label>
                    <input type="password" id="supportEmployeeConfirmPassword" placeholder="Repita a senha" required>
                </div>
                <button type="submit" class="btn-primary">
                    <i class='bx bx-check-circle'></i> Salvar Funcion√°rio
                </button>
            </form>
        </div>
    </div>

    <!-- Onboarding de Contribuinte - DEVE ESTAR FORA DO supportApp -->
    <div class="contributor-onboarding hidden" id="supportContributorOnboarding">
      <div class="contributor-onboarding-dialog">
        <div class="contributor-onboarding-header">
          <h2>Bem-vindo, <span id="supportContributorWelcomeName">Contribuinte</span>!</h2>
          <p>Antes de acessar o suporte, confirme seus dados e defina uma nova senha.</p>
        </div>
        
        <div class="contributor-onboarding-body">
          <div class="contributor-onboarding-section">
            <h3>Resumo do cadastro</h3>
            <ul class="contributor-info-list" id="supportContributorInfoList">
              <!-- Dados preenchidos dinamicamente -->
            </ul>
          </div>
          
          <form id="supportContributorOnboardingForm" data-contributor-id="" autocomplete="off">
            <div class="form-row">
              <div class="form-field">
                <label>Nova senha <span class="required">*</span></label>
                <input type="password" id="supportContributorNewPassword" placeholder="Digite a nova senha" required>
              </div>
              <div class="form-field">
                <label>Confirmar nova senha <span class="required">*</span></label>
                <input type="password" id="supportContributorConfirmPassword" placeholder="Repita a nova senha" required>
              </div>
            </div>
            
            <div class="form-row single">
              <label class="confirm-checkbox">
                <input type="checkbox" id="supportContributorConfirmData">
                <span>Confirmo que conferi meus dados e est√£o corretos.</span>
              </label>
            </div>
            
            <div class="form-row single">
              <button type="submit" class="btn-confirm-onboarding">
                <i class='bx bx-check'></i> Confirmar e acessar o suporte
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div id="supportApp" class="support-app" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo"><img src="../../assets/images/logo.png" onerror="this.onerror=null; this.src='../../assets/images/profile-1.png'" alt="logo"></div>
            
            <div class="center-icons">
                <button class="active" data-section="support" aria-label="Abrir suporte">
                    <i class='bx bx-message-dots' aria-hidden="true"></i>
                    <span class="icon-label">Suporte</span>
                </button>
                <button data-section="ncm" aria-label="Abrir consulta NCM">
                    <i class='bx bx-search' aria-hidden="true"></i>
                    <span class="icon-label">Consulta NCM</span>
                </button>
                <button data-section="recruitment" aria-label="Abrir solicita√ß√£o de recrutamento">
                    <i class='bx bx-briefcase' aria-hidden="true"></i>
                    <span class="icon-label">Solicita√ß√£o de Recrutamento</span>
                </button>
                <button id="supportAddEmployeeButton" aria-label="Cadastrar funcion√°rio">
                    <i class='bx bx-user-plus' aria-hidden="true"></i>
                    <span class="icon-label">Cadastrar Funcion√°rio</span>
                </button>
            </div>
            
            <button class="settings" id="supportLogoutButton" title="Logout" aria-label="Fazer logout">
                <i class='bx bx-log-out' aria-hidden="true"></i>
            </button>
        </div>

        <!-- Support Chat Container -->
        <div class="support-chat-container" id="supportSection" data-section="support">
            <!-- Notifica√ß√µes Container (aparece quando n√£o h√° chat aberto) -->
            <div class="notifications-container" id="notificationsContainer">
                <div class="notifications-list" id="notificationsList">
                    <!-- Notifica√ß√µes ser√£o adicionadas dinamicamente -->
                </div>
            </div>
            
            <!-- Chat Main (√°rea de conversa) -->
            <div class="chat-main" id="supportChatMain">
                <div class="chat-header">
                    <div class="header-info">
                        <img src="../../assets/images/Sercon.png" onerror="this.src='../../assets/images/logo.png'" alt="Sercon">
                        <div class="header-text">
                            <h3 id="chatHeaderTitle">Suporte Sercon</h3>
                            <p id="chatHeaderSubtitle" class="header-subtitle"></p>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="change-sector-btn-header" id="changeSectorBtnHeader" title="Trocar setor">
                            <i class='bx bx-refresh'></i>
                        </button>
                        <div class="view-mode-container">
                            <button class="view-mode-button" id="viewModeButton" title="Modo de visualiza√ß√£o">
                                <i class='bx bx-expand'></i>
                            </button>
                            <div class="view-mode-dropdown" id="viewModeDropdown">
                                <div class="view-mode-option active" data-mode="popup">
                                    <i class='bx bx-window'></i>
                                    <span>Pop-up</span>
                                    <i class='bx bx-check view-mode-check'></i>
                                </div>
                                <div class="view-mode-option" data-mode="half">
                                    <i class='bx bx-dock-right'></i>
                                    <span>Metade</span>
                                    <i class='bx bx-check view-mode-check'></i>
                                </div>
                                <div class="view-mode-option" data-mode="fullscreen">
                                    <i class='bx bx-fullscreen'></i>
                                    <span>Maximizado</span>
                                    <i class='bx bx-check view-mode-check'></i>
                                </div>
                            </div>
                        </div>
                        <button class="close-chat" id="closeChat" aria-label="Fechar chat">
                            <i class='bx bx-x'></i>
                        </button>
                    </div>
                </div>

        <div class="messages" id="chatMessages">
          <!-- Welcome message ser√° adicionado dinamicamente quando necess√°rio -->
        </div>

        
        
        <div class="message-input">

          <!-- Painel de Emojis Animados Noto -->

          <div class="emoji-panel" id="emojiPanel">

            <div class="emoji-panel-header">

              <span class="emoji-panel-title">Emojis Animados</span>

              <span class="emoji-panel-count" id="emojiPanelCount">0 emojis</span>

            </div>

            <div class="emoji-categories">

              <button class="emoji-category active" data-category="smileys" title="Rostos e Emo√ß√µes">üòä</button>

              <button class="emoji-category" data-category="hearts" title="Cora√ß√µes e S√≠mbolos">üíñ</button>

              <button class="emoji-category" data-category="gestures" title="Gestos e Pessoas">üëã</button>

              <button class="emoji-category" data-category="animals" title="Animais e Natureza">ü¶Å</button>

              <button class="emoji-category" data-category="food" title="Comidas e Bebidas">üçï</button>

              <button class="emoji-category" data-category="objects" title="Objetos e Atividades">üéÆ</button>

            </div>

            <div class="emoji-grid" id="emojiGrid">

              <!-- Emojis Noto Animation ser√£o inseridos aqui -->

            </div>

          </div>

          
          
          <input type="file" id="fileInput" style="display: none;" multiple>

          <button class="attach-button" id="attachButton" title="Anexar arquivo" aria-label="Anexar arquivo">

            <i class='bx bx-paperclip' aria-hidden="true"></i>

          </button>

          <button class="emoji-button" id="emojiButton" title="Emojis" aria-label="Adicionar emoji">

            <i class='bx bx-happy' aria-hidden="true"></i>

          </button>

          <input type="text" id="messageInput" placeholder="Digite sua mensagem aqui..." aria-label="Campo de mensagem">

          <button type="button" class="send-button" id="sendButton" aria-label="Enviar mensagem">

            <i class='bx bx-send' aria-hidden="true"></i>

          </button>

        </div>
            </div>
        </div>

        <!-- Consulta NCM Container (apenas aba) -->
        <div class="ncm-container hidden" id="ncmSection" data-section="ncm">
            <div class="ncm-main">
                <div class="ncm-header">
                    <div class="header-info">
                        <img src="../../assets/images/Sercon.png" onerror="this.src='../../assets/images/logo.png'" alt="Sercon">
                        <div class="header-text">
                            <h3>üß† Consult - NCM</h3>
                            <p class="header-subtitle">Consulta Avan√ßada de Nomenclatura Comum do Mercosul</p>
                        </div>
                    </div>
                </div>
                <div class="ncm-content">
                    <div style="padding: 24px;">
                        <h2 style="margin: 0 0 8px 0; font-size: 1.25em;">Consulta NCM</h2>
                        <p style="margin: 0; color: #6b7280;">Consulta de Produto, Controle de Vencimentos e Correla√ß√£o de Produtos.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Solicita√ß√£o de Recrutamento Container -->
        <div class="recruitment-container hidden" id="recruitmentSection" data-section="recruitment">
            <div class="recruitment-main">
                <div class="recruitment-header">
                    <div class="header-info">
                        <img src="../../assets/images/Sercon.png" onerror="this.src='../../assets/images/logo.png'" alt="Sercon">
                        <div class="header-text">
                            <h3>üíº Solicita√ß√£o de Recrutamento</h3>
                            <p class="header-subtitle">Solicite a abertura de vagas para recrutamento de funcion√°rios</p>
                        </div>
                    </div>
                </div>

                <div class="recruitment-content">
                    <!-- Formul√°rio de Solicita√ß√£o -->
                    <div class="recruitment-form-section" id="recruitmentFormSection">
                        <div class="form-header">
                            <h2>üìù Nova Solicita√ß√£o de Vaga</h2>
                            <p>Preencha todas as informa√ß√µes sobre a vaga de emprego</p>
                        </div>

                        <form id="recruitmentRequestForm" class="recruitment-form">
                            <!-- Informa√ß√µes B√°sicas -->
                            <div class="form-section">
                                <h3 class="section-title">Informa√ß√µes B√°sicas</h3>
                                
                                <div class="form-row">
                                    <div class="form-field">
                                        <label for="jobTitle">Nome do Cargo <span class="required">*</span></label>
                                        <input 
                                            type="text" 
                                            id="jobTitle" 
                                            placeholder="Ex: Analista Fiscal, Assistente Cont√°bil, Contador..."
                                            required
                                        >
                                    </div>
                                    <div class="form-field">
                                        <label for="vacancyQuantity">Quantidade de Vagas <span class="required">*</span></label>
                                        <input 
                                            type="number" 
                                            id="vacancyQuantity" 
                                            min="1" 
                                            placeholder="Ex: 2"
                                            required
                                        >
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-field">
                                        <label for="salary">Sal√°rio <span class="required">*</span></label>
                                        <input 
                                            type="text" 
                                            id="salary" 
                                            placeholder="Ex: R$ 3.500,00 ou A combinar"
                                            required
                                        >
                                    </div>
                                    <div class="form-field">
                                        <label for="workSchedule">Regime de Trabalho <span class="required">*</span></label>
                                        <select id="workSchedule" required>
                                            <option value="">Selecione...</option>
                                            <option value="CLT">CLT (Tempo Integral)</option>
                                            <option value="PJ">PJ (Pessoa Jur√≠dica)</option>
                                            <option value="Est√°gio">Est√°gio</option>
                                            <option value="Tempor√°rio">Tempor√°rio</option>
                                            <option value="Meio Per√≠odo">Meio Per√≠odo</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Prefer√™ncia de Proximidade -->
                            <div class="form-section">
                                <h3 class="section-title">Localiza√ß√£o e Proximidade</h3>
                                
                                <div class="form-row">
                                    <div class="form-field">
                                        <label for="locationPreference">Prefer√™ncia de Proximidade <span class="required">*</span></label>
                                        <select id="locationPreference" required onchange="handleLocationPreferenceChange()">
                                            <option value="">Selecione a prefer√™ncia...</option>
                                            <option value="qualquer">Qualquer localiza√ß√£o (Remoto ou Presencial)</option>
                                            <option value="remoto">Apenas Remoto</option>
                                            <option value="presencial">Apenas Presencial</option>
                                            <option value="hibrido">H√≠brido (Remoto + Presencial)</option>
                                            <option value="proximo">Proximidade obrigat√≥ria</option>
                                            <option value="mesma_cidade">Mesma cidade</option>
                                            <option value="mesmo_estado">Mesmo estado</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Campos adicionais para proximidade obrigat√≥ria -->
                                <div id="proximityFields" style="display: none;">
                                    <div class="form-row">
                                        <div class="form-field">
                                            <label for="companyAddress">Endere√ßo da Empresa <span class="required">*</span></label>
                                            <input 
                                                type="text" 
                                                id="companyAddress" 
                                                placeholder="Ex: Rua Exemplo, 123 - Centro - S√£o Paulo/SP"
                                            >
                                        </div>
                                        <div class="form-field">
                                            <label for="maxDistance">Dist√¢ncia M√°xima (km) <span class="required">*</span></label>
                                            <input 
                                                type="number" 
                                                id="maxDistance" 
                                                min="1" 
                                                max="100"
                                                step="1"
                                                placeholder="Ex: 10"
                                            >
                                            <small style="color: #6b7280; font-size: 12px; margin-top: 4px; display: block;">
                                                Dist√¢ncia m√°xima em quil√¥metros do endere√ßo da empresa
                                            </small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Requisitos e Qualifica√ß√µes -->
                            <div class="form-section">
                                <h3 class="section-title">Requisitos e Qualifica√ß√µes</h3>
                                
                                <div class="form-row">
                                    <div class="form-field">
                                        <label for="educationLevel">Escolaridade M√≠nima</label>
                                        <select id="educationLevel">
                                            <option value="">N√£o especificado</option>
                                            <option value="fundamental">Ensino Fundamental</option>
                                            <option value="medio">Ensino M√©dio</option>
                                            <option value="tecnico">T√©cnico</option>
                                            <option value="superior">Superior</option>
                                            <option value="pos_graduacao">P√≥s-Gradua√ß√£o</option>
                                        </select>
                                    </div>
                                    <div class="form-field">
                                        <label for="experienceRequired">Experi√™ncia Necess√°ria</label>
                                        <select id="experienceRequired">
                                            <option value="">N√£o especificado</option>
                                            <option value="sem_experiencia">Sem experi√™ncia</option>
                                            <option value="6_meses">6 meses</option>
                                            <option value="1_ano">1 ano</option>
                                            <option value="2_anos">2 anos</option>
                                            <option value="3_anos">3 anos</option>
                                            <option value="5_anos">5 anos ou mais</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-field full-width">
                                        <label for="requiredSkills">Habilidades e Compet√™ncias Necess√°rias</label>
                                        <textarea 
                                            id="requiredSkills" 
                                            rows="3"
                                            placeholder="Ex: Conhecimento em Excel avan√ßado, experi√™ncia com sistemas fiscais, conhecimento em contabilidade..."
                                        ></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- Descri√ß√£o da Vaga -->
                            <div class="form-section">
                                <h3 class="section-title">Descri√ß√£o da Vaga</h3>
                                
                                <div class="form-row">
                                    <div class="form-field full-width">
                                        <label for="jobDescription">Descri√ß√£o Detalhada da Vaga <span class="required">*</span></label>
                                        <textarea 
                                            id="jobDescription" 
                                            rows="6"
                                            placeholder="Descreva as atividades, responsabilidades e expectativas do cargo..."
                                            required
                                        ></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- Informa√ß√µes Adicionais -->
                            <div class="form-section">
                                <h3 class="section-title">Informa√ß√µes Adicionais</h3>
                                
                                <div class="form-row">
                                    <div class="form-field">
                                        <label for="benefits">Benef√≠cios Oferecidos</label>
                                        <textarea 
                                            id="benefits" 
                                            rows="3"
                                            placeholder="Ex: Vale refei√ß√£o, plano de sa√∫de, vale transporte, aux√≠lio home office..."
                                        ></textarea>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-field">
                                        <label for="contactEmail">E-mail para Contato</label>
                                        <input 
                                            type="email" 
                                            id="contactEmail" 
                                            placeholder="Ex: rh@empresa.com.br"
                                        >
                                    </div>
                                    <div class="form-field">
                                        <label for="contactPhone">Telefone para Contato</label>
                                        <input 
                                            type="tel" 
                                            id="contactPhone" 
                                            placeholder="Ex: (11) 99999-9999"
                                        >
                                    </div>
                                </div>
                            </div>

                            <!-- Bot√£o de Envio -->
                            <div class="form-actions">
                                <button type="submit" class="btn-submit-recruitment">
                                    <i class='bx bx-send'></i> Enviar Solicita√ß√£o
                                </button>
                                <button type="reset" class="btn-reset-form">
                                    <i class='bx bx-refresh'></i> Limpar Formul√°rio
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Mensagem de Sucesso -->
                    <div class="recruitment-success hidden" id="recruitmentSuccess">
                        <div class="success-icon">‚úÖ</div>
                        <h3>Solicita√ß√£o Enviada com Sucesso!</h3>
                        <p>Sua solicita√ß√£o de recrutamento foi enviada e ser√° analisada pela equipe de administra√ß√£o.</p>
                        <button class="btn-new-request" onclick="resetRecruitmentForm()">
                            <i class='bx bx-plus'></i> Nova Solicita√ß√£o
                        </button>
                    </div>
                </div>
            </div>
        </div>

            <!-- Bot√£o de Suporte (inicial) -->
    <button class="support-button" id="supportButton">
        <i class='bx bx-message-dots'></i>
        <span>Suporte</span>
    </button>


    <!-- Modal de Sele√ß√£o de Setor -->
    <div class="sector-modal" id="sectorModal">
        <div class="sector-modal-content">
            <div class="sector-modal-header">
                <h3>Selecione o Setor de Atendimento</h3>
                <p>Escolha o setor respons√°vel pelo seu atendimento</p>
            </div>
            <div class="sector-options">
                <button class="sector-option" data-sector="Fiscal Real">
                    <i class='bx bxs-user'></i>
                    <span>Fiscal Real</span>
                </button>
                <button class="sector-option" data-sector="Fiscal Simples">
                    <i class='bx bxs-user'></i>
                    <span>Fiscal Simples</span>
                </button>
                <button class="sector-option" data-sector="Processo">
                    <i class='bx bxs-user'></i>
                    <span>Processo</span>
                </button>
                <button class="sector-option" data-sector="Cont√°bil">
                    <i class='bx bxs-user'></i>
                    <span>Cont√°bil</span>
                </button>
                <button class="sector-option" data-sector="Pessoal">
                    <i class='bx bxs-user'></i>
                    <span>Pessoal</span>
                </button>
                <button class="sector-option" data-sector="Financeiro">
                    <i class='bx bxs-user'></i>
                    <span>Financeiro</span>
                </button>
            </div>
            <button class="sector-modal-close" id="closeSectorModal">
                Cancelar
            </button>
        </div>

    <!-- Script Principal -->
    <script src="Suporte-script.js"></script>
    <!-- Script para Controle do Formul√°rio de Recrutamento -->
    <script>
        // Fun√ß√£o para controlar a exibi√ß√£o dos campos de proximidade
        function handleLocationPreferenceChange() {
            const locationPreference = document.getElementById('locationPreference');
            const proximityFields = document.getElementById('proximityFields');
            const companyAddress = document.getElementById('companyAddress');
            const maxDistance = document.getElementById('maxDistance');
            
            if (locationPreference.value === 'proximo') {
                // Mostrar campos de proximidade
                proximityFields.style.display = 'block';
                companyAddress.required = true;
                maxDistance.required = true;
            } else {
                // Esconder campos de proximidade
                proximityFields.style.display = 'none';
                companyAddress.required = false;
                maxDistance.required = false;
                // Limpar valores quando esconder
                companyAddress.value = '';
                maxDistance.value = '';
            }
        }
        
        // Fun√ß√£o para resetar o formul√°rio
        function resetRecruitmentForm() {
            const form = document.getElementById('recruitmentRequestForm');
            const recruitmentFormSection = document.getElementById('recruitmentFormSection');
            const recruitmentSuccess = document.getElementById('recruitmentSuccess');
            
            if (form) {
                form.reset();
                // Esconder campos de proximidade ao resetar
                handleLocationPreferenceChange();
            }
            
            // Mostrar formul√°rio e esconder mensagem de sucesso
            if (recruitmentFormSection) {
                recruitmentFormSection.style.display = 'block';
            }
            if (recruitmentSuccess) {
                recruitmentSuccess.classList.add('hidden');
            }
        }
        
        // Adicionar event listener ao formul√°rio quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('recruitmentRequestForm');
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Validar campos de proximidade se necess√°rio
                    const locationPreference = document.getElementById('locationPreference');
                    if (locationPreference.value === 'proximo') {
                        const companyAddress = document.getElementById('companyAddress');
                        const maxDistance = document.getElementById('maxDistance');
                        
                        if (!companyAddress.value.trim()) {
                            alert('Por favor, preencha o endere√ßo da empresa.');
                            companyAddress.focus();
                            return;
                        }
                        
                        if (!maxDistance.value || parseFloat(maxDistance.value) <= 0) {
                            alert('Por favor, informe a dist√¢ncia m√°xima em quil√¥metros (valor maior que 0).');
                            maxDistance.focus();
                            return;
                        }
                    }
                    
                    // Coletar dados do formul√°rio
                    const formData = {
                        id: 'recruitment_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                        jobTitle: document.getElementById('jobTitle').value,
                        vacancyQuantity: parseInt(document.getElementById('vacancyQuantity').value),
                        salary: document.getElementById('salary').value,
                        workSchedule: document.getElementById('workSchedule').value,
                        locationPreference: document.getElementById('locationPreference').value,
                        companyAddress: document.getElementById('companyAddress').value || null,
                        maxDistance: document.getElementById('maxDistance').value ? parseInt(document.getElementById('maxDistance').value) : null,
                        educationLevel: document.getElementById('educationLevel').value || null,
                        experienceRequired: document.getElementById('experienceRequired').value || null,
                        requiredSkills: document.getElementById('requiredSkills').value || null,
                        jobDescription: document.getElementById('jobDescription').value,
                        benefits: document.getElementById('benefits').value || null,
                        contactEmail: document.getElementById('contactEmail').value || null,
                        contactPhone: document.getElementById('contactPhone').value || null,
                        status: 'pending', // pending, approved, rejected, redirected
                        createdAt: new Date().toISOString(),
                        contributorId: (function() {
                            try {
                                const supportUser = JSON.parse(localStorage.getItem('supportCurrentUser') || 'null');
                                return supportUser?.contributorId || null;
                            } catch (e) {
                                return null;
                            }
                        })(),
                        contributorName: (function() {
                            try {
                                const supportUser = JSON.parse(localStorage.getItem('supportCurrentUser') || 'null');
                                if (supportUser?.contributorId) {
                                    const contributors = JSON.parse(localStorage.getItem('contributors') || '[]');
                                    const contributor = contributors.find(c => c.id === supportUser.contributorId);
                                    return contributor?.razaoSocial || supportUser.fullName || 'Contribuinte n√£o identificado';
                                }
                                return supportUser?.fullName || 'Contribuinte n√£o identificado';
                            } catch (e) {
                                return 'Contribuinte n√£o identificado';
                            }
                        })()
                    };
                    
                    // Salvar no localStorage
                    try {
                        const existingRequests = JSON.parse(localStorage.getItem('recruitmentRequests') || '[]');
                        existingRequests.push(formData);
                        localStorage.setItem('recruitmentRequests', JSON.stringify(existingRequests));
                        localStorage.setItem('recruitmentRequestsUpdatedAt', Date.now().toString());
                        
                        console.log('‚úÖ Solicita√ß√£o de recrutamento salva com sucesso:', formData);
                    } catch (error) {
                        console.error('‚ùå Erro ao salvar solicita√ß√£o:', error);
                        alert('Erro ao enviar solicita√ß√£o. Por favor, tente novamente.');
                        return;
                    }
                    
                    // Mostrar mensagem de sucesso
                    const recruitmentFormSection = document.getElementById('recruitmentFormSection');
                    const recruitmentSuccess = document.getElementById('recruitmentSuccess');
                    
                    if (recruitmentFormSection) {
                        recruitmentFormSection.style.display = 'none';
                    }
                    if (recruitmentSuccess) {
                        recruitmentSuccess.classList.remove('hidden');
                    }
                    
                    // Scroll para o topo
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }
        });
    </script>
</body>
</html>